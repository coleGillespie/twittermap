// Test Observer
// -------------------------------------------------- //

App.Wiretap(function(socket) {


  this.index = function(req, res) {
    
    Todo.save({ task: "foobar" }, function(err, data) {

      Todo.find(1, function(err, data) {
        console.log(arguments);
      });

    });

    
    res.render("index", { tasks : [] });

  };


  // Socket Events ------------------------------------ //

  socket.newTodo = function(data) {
    Todo.save({ task: data.task, done: false }, function(err, doc) {  
      Todo.send(doc.id, "newTodo");
    });
  };

  socket.complete = function(data) {
    Todo.update(data._id, { done: true });
  };
  

  // Database events ---------------------------------- //

  App.on("change-todo", function(change, doc) {
    doc.done && App.send("update-list", doc);
  });


});
