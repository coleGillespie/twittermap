// User Model for Auth
// -------------------------------------------------- //

// Let's be secure about this
var bcrypt = require('bcrypt');

// -------------------------------------------------- //

User = new Telegraph.Model("User", {
    first_name : String,
    last_name  : String,
    username   : { type: String, unique: true, required: true, lowercase: true, trim: true },
    password   : { type: String, required: true}
});

User.schema.pre('save', function (next) {

    var user = this;

    bcrypt.gen_salt(10, function(err, salt) {

        bcrypt.encrypt(user.password, salt, function(err, hash) {
      
            user.password = hash;
            next();

        });
    });

});
